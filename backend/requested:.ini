requested:

   1. Security Issues
   2. Logic & Data Integrity Issues
   3. Code & Performance Issues

  ---

  1. Security Issues

  These are vulnerabilities that could be exploited by an attacker to compromise your system, steal
  data, or gain unauthorized access.

   * Issue: Insecure Device Authentication
       * Severity: Critical
       * Location(s): middleware/deviceAuth.js, server.js
       * Explanation: Biometric devices are authenticated using only a non-secret serial number sent in
         the URL. An attacker on the network can easily find this number and use it to impersonate a
         device, allowing them to forge attendance records and steal student data.

   * Issue: Sensitive Data Exposure in API Response
       * Severity: High
       * Location(s): controllers/authController.js (in the getMe function)
       * Explanation: The API endpoint that returns a user's profile (/api/v1/auth/me) includes the
         user's password hash in the response. This hash could be captured by an attacker and used in
         offline attacks to try and discover the user's original password.

   * Issue: Inconsistent Authorization Checks
       * Severity: Medium
       * Location(s): Throughout the controllers/ directory
       * Explanation: The application does not consistently use its security middleware. Some parts of
         the code rely on developers to manually add security checks. This is risky because a forgotten
         check in a new or updated feature could create a security hole, potentially allowing users from
          one school to access another school's data.

  ---

  2. Logic & Data Integrity Issues

  These are bugs where the code runs without crashing but produces incorrect results, corrupts your
  data, or is guaranteed to fail in the future.

   * Issue: Timezone Mismanagement
       * Severity: Critical
       * Location(s): controllers/attendanceController.js, controllers/schoolController.js,
         controllers/teacherController.js
       * Explanation: The code uses the server's UTC time to record dates, not the local time in India.
         This causes attendance marked in the late evening or early morning to be saved for the wrong 
         day. This is a critical data corruption bug that makes your attendance records unreliable.

   * Issue: Hardcoded Academic Year
       * Severity: High
       * Location(s): controllers/authController.js, controllers/teacherController.js
       * Explanation: The code has the year '2025-2026' written directly into it. As soon as the school
         year changes, features like fetching a teacher's class assignments will break, because the code
          will still be asking the database for the previous year's data. This is a "logic time bomb"
         that guarantees the app will fail.

   * Issue: Missing Database Transactions
       * Severity: High
       * Location(s): models/Teacher.js, models/School.js
       * Explanation: Creating a new teacher requires two separate database writes (one to users, one to
          teachers). These are not grouped in a transaction. If the second write fails, you will have a
         corrupted "orphan" user in your database, which can cause unpredictable errors.

   * Issue: Catastrophic Data Loss Risk in Database Design
       * Severity: High (Latent Risk)
       * Location(s): config/migrate.js
       * Explanation: The database is designed with ON DELETE CASCADE. This means if a school record is
         ever accidentally deleted, the database will automatically and permanently delete all students,
          teachers, classes, and attendance records for that school. This is an extremely risky design.

   * Issue: Race Condition in Form Teacher Assignment
       * Severity: Medium
       * Location(s): models/Teacher.js
       * Explanation: If two admins try to assign a form teacher to the same class at the same time, the
          system can save the wrong data because the operation is not atomic (it's not a single,
         indivisible step). This leads to incorrect teacher assignments in the database.

  ---

  3. Code & Performance Issues

  These are problems related to the quality, structure, and speed of your code. They make the app
  harder to maintain and slower for the user.

   * Issue: N+1 Query Problem
       * Severity: Medium
       * Location(s): models/Teacher.js (in the findAll function)
       * Explanation: To get a list of 100 teachers and their assignments, the code runs 101 separate
         database queries. This is extremely inefficient and will make your application very slow as it
         scales.

   * Issue: Inefficient Report Generation
       * Severity: Medium
       * Location(s): controllers/reportsController.js
       * Explanation: The monthly report loads all attendance data for the entire month into memory to
         perform calculations. For a large school, this will be very slow and could crash your server
         due to high memory usage.

   * Issue: Duplicate and Unused Code
       * Severity: Medium
       * Location(s): controllers/ directory
       * Explanation: The project contains three different files (iclockController.js, Untitled-1.js,
         Untitled-2.js) with the same code for device communication. This makes the code very difficult
         to maintain and increases the risk that a bug fixed in one file will remain in the others.

   * Issue: Inconsistent Naming and Error Handling
       * Severity: Low
       * Location(s): Throughout the codebase
       * Explanation: The code mixes different naming styles (camelCase and snake_case) and has an
         inconsistent strategy for handling errors. This makes the code harder to read, understand, and
         debug for you and any future developers.


╭────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ >   Type your message or @path/to/file                                                             │
╰────────────────────────────────────────────────────────────────────────────────────────────────────╯
 /school-attendance-sysytem          no sandbox (see    gemini-2.5-pr | ✖ 1 error (ctrl+o for 
 (master*)                           /docs)             o               details)
i