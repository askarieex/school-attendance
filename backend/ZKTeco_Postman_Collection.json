{
  "info": {
    "name": "ZKTeco K40 Pro Integration",
    "description": "Test endpoints for ZKTeco device communication",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. Test Device Authentication (Should return OK)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3001/iclock/getrequest?SN=TEST123456789",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3001",
          "path": ["iclock", "getrequest"],
          "query": [
            {
              "key": "SN",
              "value": "TEST123456789",
              "description": "Device Serial Number"
            }
          ]
        },
        "description": "Tests if device is registered and can poll for commands. Should return 'OK' if no commands pending."
      },
      "response": []
    },
    {
      "name": "2. Submit Attendance Data (Student Scan)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "text/plain",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "101\t2025-10-18 08:45:30\t1\t15\t0\t0"
        },
        "url": {
          "raw": "http://localhost:3001/iclock/cdata?SN=TEST123456789",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3001",
          "path": ["iclock", "cdata"],
          "query": [
            {
              "key": "SN",
              "value": "TEST123456789",
              "description": "Device Serial Number"
            }
          ]
        },
        "description": "Simulates a student (PIN 101) scanning their RFID card at 8:45 AM. Should return 'OK' and save attendance."
      },
      "response": []
    },
    {
      "name": "3. Submit Multiple Attendance Records",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "text/plain",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "101\t2025-10-18 08:45:30\t1\t15\t0\t0\n102\t2025-10-18 08:47:15\t1\t15\t0\t0\n103\t2025-10-18 09:15:00\t1\t15\t0\t0"
        },
        "url": {
          "raw": "http://localhost:3001/iclock/cdata?SN=TEST123456789",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3001",
          "path": ["iclock", "cdata"],
          "query": [
            {
              "key": "SN",
              "value": "TEST123456789"
            }
          ]
        },
        "description": "Simulates multiple students scanning. Each line is a separate scan separated by newline (\\n)."
      },
      "response": []
    },
    {
      "name": "4. Test Invalid Device (Should Fail)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3001/iclock/getrequest?SN=INVALID_DEVICE",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3001",
          "path": ["iclock", "getrequest"],
          "query": [
            {
              "key": "SN",
              "value": "INVALID_DEVICE",
              "description": "Invalid serial number"
            }
          ]
        },
        "description": "Tests authentication failure. Should return 401 'ERROR: Device not registered'."
      },
      "response": []
    },
    {
      "name": "5. Queue Add User Command (Manual)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"deviceId\": 4,\n  \"commandType\": \"add_user\",\n  \"commandString\": \"C:295:DATA UPDATE user Pin=102\\tName=Sara Ahmed\\tCard=9876543210\\tPrivilege=0\",\n  \"priority\": 10\n}"
        },
        "url": {
          "raw": "http://localhost:3001/api/v1/device/commands/queue",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3001",
          "path": ["api", "v1", "device", "commands", "queue"]
        },
        "description": "Manually queue a command (you'll need to create this endpoint or use SQL directly)."
      },
      "response": []
    },
    {
      "name": "6. Poll for Command (After Queuing)",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "http://localhost:3001/iclock/getrequest?SN=TEST123456789",
          "protocol": "http",
          "host": ["localhost"],
          "port": "3001",
          "path": ["iclock", "getrequest"],
          "query": [
            {
              "key": "SN",
              "value": "TEST123456789"
            }
          ]
        },
        "description": "After queuing a command, this should return the command string instead of 'OK'."
      },
      "response": []
    }
  ]
}
